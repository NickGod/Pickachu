<p id="notice"><%= notice %></p>

<h1>Nearby goods</h1>



<!--   <div id="map_canvas"></div>
  <%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBqGHXqWZ2hO2atUBSMRZluvbz0UHCMCv4' %>
  <%= javascript_include_tag 'google_map' %>
  <%= javascript_tag do %>
  google.maps.event.addDomListener(window, 'load', initialize);
  <% end %>
     -->

 <div id="multi_markers" style='width: 100%; height: 600px;'></div>

<br>

<script> 

var handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'multi_markers'}}, function(){
  var markers = handler.addMarkers(<%=raw @hash.to_json%>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});

 var marker = null;
 google.maps.event.addListener(
  handler.getMap(), 'click', function(object){ 
    // alert('clicked');
    marker = new google.maps.Marker({position: object.latLng, map: handler.getMap()});
    handler.addMarkers(marker);
    }
  );

// function gmaps4rails_callback() {
//    var marker = null;
//    google.maps.event.addListener(
//     Gmaps.map, 'click', function(object){ 
//       alert('Clicked');
//       marker = new google.maps.Marker({position: object.latLng, map: Gmaps4Rails.map})
//       handler.addMarkers(marker);
//       }
//     );
// }


    
</script>

<!-- <%= link_to 'New Nearby', new_nearby_path %>
 -->