<div class="container">
<p id="notice"><%= notice %></p>

<h1>Listing Pickups</h1>



<!--<%= link_to "getLocation", pickups_path(@getLocation, :lng => @lng, :lat => @lat) %> -->

<%= form_tag(pickups_search_path, :method => "get", class: "navbar-form", id: "search-form") do %>
    <div class="input-append">
      <%= text_field_tag :search_des, params[:search_des], placeholder: "Search" %>
      <!-- In order to have the "search" icon int the button, we need to use plain HTML instead
           of using a Rails form helper -->
      <button class="btn btn-primary">Search Description</button>
      <!-- <button class="btn" type="submit"><i class="icon-search"></i></button> -->
    </div>
  <% end %>

<%= form_tag(pickups_search_path, :method => "get", class: "navbar-form", id: "search-form") do %>
    <div class="input-append">
      <%= number_field_tag :search_type, params[:search_type], placeholder: "Search" %>
      <!-- In order to have the "search" icon int the button, we need to use plain HTML instead
           of using a Rails form helper -->
      <button class="btn btn-primary">Search type</button>
      <!-- <button class="btn" type="submit"><i class="icon-search"></i></button> -->
    </div>
  <% end %>

<%= form_tag(pickups_search_path, :method => "get", class: "navbar-form", id: "search-area-form") do %>
    <div class="input-append">
      <% params.delete :lng %>
      <% params.delete :lat %>
      <%= hidden_field :lng, params[:lng], :id=>"curlng"%>
      <%= hidden_field :lat, params[:lat], :id=>"curlat"%>
      <script>
        if(navigator.geolocation)
          navigator.geolocation.getCurrentPosition(displayOnMap);
        function displayOnMap(position){
          $("#curlng").val(position.coords.longitude);
          $("#curlat").val(position.coords.latitude);
        };
      </script>
      <%= number_field_tag :search_area, params[:search_area], placeholder: "Input Miles" %>

      <button class="btn btn-primary">Search within miles</button>
    </div>
  <% end %>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
Create your PickUp!
</button>

<hr>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">New PickUp</h4>
      </div>
        <%= render 'form' %>
    </div>
  </div>
</div>



<table class="table">
  <thead>
    <tr>
      <th>Seller</th>
      <th>Item Name</th>
      <th>Long</th>
      <th>Lat</th>
      <th>Object Type</th>
      <th>Image url</th>
      <th>Price</th>
      <th>Start time</th>
      <th>End time</th>
      <th>Description</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @pickups.each do |pickup| %>

      <div class="col-sm-6 col-md-4">
        <div class="thumbnail">
        <!-- img url should be provided in the database entry -->

          <%= image_tag pickup.avatar.url %>

          <div class="caption">
            <h3><%= pickup.name %></h3>
            <h4> $<%= pickup.price %> </h4>
            <h4> Seller: <%= pickup.user_id %> </h4>
            <p><%= pickup.description %></p>
            <p><%= link_to 'More info', pickup, :class => "btn btn-primary" %> <%= link_to 'Edit', edit_pickup_path(pickup), :class => "btn btn-default" %></p>
          </div>
        </div>
      </div>

      <tr>
        <td><a href="/users/<%= pickup.user_id%>"> <%= getUserName(pickup.user_id) %>  </a></td>
        <td><%= pickup.name %></td>
        <td><%= pickup.lng.round(2) %></td>
        <td><%= pickup.lat.round(2) %></td>
        <td><%= pickup.obj_type %></td>
        <td><%= pickup.image_url %></td>
        <td><%= pickup.price %></td>
        <td><%= pickup.start_time %></td>
        <td><%= pickup.end_time %></td>
        <td><%= pickup.description %></td>
        <td><%= link_to 'Show', pickup %></td>
        <td><%= link_to 'Edit', edit_pickup_path(pickup) %></td>
        <td><%= link_to 'Destroy', pickup, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

</div>
